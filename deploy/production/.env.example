# sbozh.me Production Environment Configuration

# ============================================
# Database Configuration
# ============================================
DB_USER=directus
DB_PASSWORD=changeme-strong-password-here
DB_DATABASE=sbozh_me

# ============================================
# Directus Core
# ============================================
# Generate with: openssl rand -hex 32
DIRECTUS_SECRET=changeme-random-secret-32-chars-min
DIRECTUS_KEY=changeme-another-random-key-32-chars

# ============================================
# Admin Account
# ============================================
ADMIN_EMAIL=admin@yourdomain.com
ADMIN_PASSWORD=changeme-strong-admin-password

# ============================================
# Public URLs
# ============================================
PUBLIC_URL=https://crm.yourdomain.com
CORS_ORIGIN=https://crm.yourdomain.com,https://yourdomain.com

# ============================================
# Cookie Domains
# ============================================
REFRESH_TOKEN_COOKIE_DOMAIN=.yourdomain.com
SESSION_COOKIE_DOMAIN=.yourdomain.com

# ============================================
# Cache Configuration
# ============================================
CACHE_ENABLED=true
CACHE_AUTO_PURGE=true

# ============================================
# Features
# ============================================
WEBSOCKETS_ENABLED=true

# ============================================
# Security
# ============================================
REFRESH_TOKEN_COOKIE_SECURE=true
REFRESH_TOKEN_COOKIE_SAME_SITE=lax
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_SAME_SITE=lax

# ============================================
# Extensions
# ============================================
EXTENSIONS_PATH=./extensions
EXTENSIONS_AUTO_RELOAD=false

# ============================================
# Content Security Policy
# ============================================
# Leave commented to use Directus defaults
# CONTENT_SECURITY_POLICY_DIRECTIVES__FRAME_SRC=self

# ============================================
# Email Configuration (SMTP)
# ============================================
EMAIL_TRANSPORT=smtp
EMAIL_FROM=noreply@yourdomain.com
EMAIL_SMTP_HOST=smtp.yourdomain.com
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USER=noreply@yourdomain.com
EMAIL_SMTP_PASSWORD=changeme-smtp-password
# For port 587 (STARTTLS), use false. For port 465 (SSL/TLS), use true
EMAIL_SMTP_SECURE=false

# ============================================
# Logging
# ============================================
LOG_LEVEL=info

# ============================================
# Deployment Environment
# ============================================
# Specifies the deployment environment: 'dev' or 'prod'
# When deploying with deploy-dev.sh, set to 'dev' for [DEV-PROD] badge
# When deploying with deploy.sh, set to 'prod' for [PROD] badge
# This affects Discord notification badges only
DEPLOYMENT_ENV=dev

# ============================================
# Service Authentication
# ============================================
# API token for service-to-service authentication with Directus
# Generate in Directus: Settings ‚Üí Access Tokens ‚Üí Create Static Token
DIRECTUS_TOKEN=changeme-static-token-from-directus

# ============================================
# Discord Notification Service
# ============================================
# Production-ready notification service with enterprise features:
# - Rich Discord embeds with severity color coding
# - Multi-channel webhook routing by severity
# - Rate limiting to prevent alert fatigue
# - Enhanced diagnostic context (request IDs, stack traces)
# - Environment indicators (DEV/STAGING/PROD)

# Default webhook (fallback for all severities) - REQUIRED
# Get from: Discord Server Settings ‚Üí Integrations ‚Üí Webhooks ‚Üí New Webhook
# Example: https://discord.com/api/webhooks/123456789012345678/abcdef...
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN

# Severity-specific webhooks (optional)
# If configured, notifications will be routed to severity-specific channels
# Falls back to DISCORD_WEBHOOK_URL if severity-specific webhook not set

# Critical severity webhook (üö® red alerts)
# DISCORD_WEBHOOK_CRITICAL=https://discord.com/api/webhooks/CRITICAL_ID/CRITICAL_TOKEN

# Warning severity webhook (‚ö†Ô∏è orange warnings)
# DISCORD_WEBHOOK_WARNING=https://discord.com/api/webhooks/WARNING_ID/WARNING_TOKEN

# Info severity webhook (‚ÑπÔ∏è blue info)
# DISCORD_WEBHOOK_INFO=https://discord.com/api/webhooks/INFO_ID/INFO_TOKEN

# Rate limiting configuration
# Maximum notifications per hour (default: 10)
# Prevents alert fatigue by limiting notification volume
# Returns 429 (Too Many Requests) when limit exceeded
# RATE_LIMIT_PER_HOUR=10

# ============================================
# Analytics (Umami)
# ============================================
# Umami database credentials (shared PostgreSQL instance)
UMAMI_DB_USER=umami
UMAMI_DB_PASSWORD=changeme-umami-db-password
UMAMI_DB_NAME=umami

# Umami app secret (generate with: openssl rand -hex 32)
UMAMI_APP_SECRET=changeme-umami-app-secret-32-chars

# Website tracking config (get from Umami dashboard after setup)
UMAMI_WEBSITE_ID=
UMAMI_SCRIPT_URL=https://analytics.sbozh.me/script.js
ANALYTICS_ENABLED=true

# ============================================
# Web Service (GitOps)
# ============================================
# Image tag for the web service (controlled by manifest.yaml)
WEB_IMAGE_TAG=main
DIRECTUS_URL=https://directus.sbozh.me

# ============================================
# SSL (Cloudflare DNS-01 Challenge)
# ============================================
# Cloudflare API token for wildcard SSL certificate
# Create at: https://dash.cloudflare.com/profile/api-tokens
# Permissions: Zone:DNS:Edit for sbozh.me
# Store in /root/.cloudflare.ini on server (chmod 600)
CLOUDFLARE_API_TOKEN=changeme-cloudflare-api-token
